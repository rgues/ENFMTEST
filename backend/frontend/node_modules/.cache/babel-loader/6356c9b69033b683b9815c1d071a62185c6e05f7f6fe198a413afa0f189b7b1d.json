{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { GET_REQUESTS, GET_ASSIGNATIONS, GET_CATEGORIES, GET_USERS } from '../store/types';\nimport { format } from \"date-fns\";\nimport { onMounted } from 'vue';\nimport { ref } from 'vue';\nimport store from '../store';\nimport router from '../routes';\nexport default {\n  __name: 'Assignation',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const categories = ref([]);\n    const users = ref([]);\n    const requests = ref([]);\n    const assignations = ref([]);\n    const currentUser = ref(null);\n    onMounted(async () => {\n      categories.value = await store.dispatch(GET_CATEGORIES);\n      users.value = await store.dispatch(GET_USERS);\n      requests.value = await store.dispatch(GET_REQUESTS);\n      assignations.value = await store.dispatch(GET_ASSIGNATIONS);\n      currentUser.value = store.state.user.loginData.user;\n    });\n    function categoryName(id) {\n      return categories.value.filter(item => item.id === id).map(item => item ? item.name : '')[0];\n    }\n    function userName(id) {\n      return users.value.filter(item => item.id === id).map(item => item ? item.firstname + ' ' + item.lastname : '')[0];\n    }\n    function requestDescription(id) {\n      return id ? requests.value.find(item => item.id === id) : '';\n    }\n    function answerRequest(item) {\n      router.push(`/admin/dashboard/sentAnswer/${item.id}`);\n    }\n    function reassignRequest(item) {\n      router.push(`/admin/dashboard/reassign/${item.request_id}/${item.user_id}`);\n    }\n    function formatDate(date) {\n      return format(date, \"yyyy-MM-dd\");\n    }\n    const __returned__ = {\n      categories,\n      users,\n      requests,\n      assignations,\n      currentUser,\n      categoryName,\n      userName,\n      requestDescription,\n      answerRequest,\n      reassignRequest,\n      formatDate,\n      get GET_REQUESTS() {\n        return GET_REQUESTS;\n      },\n      get GET_ASSIGNATIONS() {\n        return GET_ASSIGNATIONS;\n      },\n      get GET_CATEGORIES() {\n        return GET_CATEGORIES;\n      },\n      get GET_USERS() {\n        return GET_USERS;\n      },\n      get format() {\n        return format;\n      },\n      onMounted,\n      ref,\n      get store() {\n        return store;\n      },\n      get router() {\n        return router;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["GET_REQUESTS","GET_ASSIGNATIONS","GET_CATEGORIES","GET_USERS","format","onMounted","ref","store","router","categories","users","requests","assignations","currentUser","value","dispatch","state","user","loginData","categoryName","id","filter","item","map","name","userName","firstname","lastname","requestDescription","find","answerRequest","push","reassignRequest","request_id","user_id","formatDate","date"],"sources":["C:/Users/HP/Desktop/ENFM/Customer_v2/client/src/views/Assignation.vue"],"sourcesContent":["\r\n<script setup>\r\nimport { GET_REQUESTS,GET_ASSIGNATIONS, GET_CATEGORIES, GET_USERS} from '../store/types'\r\nimport { format } from \"date-fns\"\r\nimport { onMounted } from 'vue'\r\nimport { ref } from 'vue'\r\nimport store from '../store'\r\nimport router from '../routes'\r\n\r\n   const categories = ref([])\r\n   const users = ref([])\r\n   const requests = ref([])\r\n   const assignations = ref([])\r\n   const currentUser = ref(null)\r\n\r\n onMounted(async () => { \r\n       categories.value = await store.dispatch(GET_CATEGORIES);\r\n       users.value = await store.dispatch(GET_USERS);\r\n       requests.value = await store.dispatch(GET_REQUESTS);\r\n       assignations.value = await store.dispatch(GET_ASSIGNATIONS);\r\n       currentUser.value = store.state.user.loginData.user\r\n})\r\n\r\n\r\n       function categoryName(id) {\r\n           return categories.value.filter(item => item.id === id)\r\n                                  .map(item=>item ? item.name : '')[0];\r\n        }\r\n\r\n        function userName(id) {\r\n           return users.value.filter(item => item.id === id)\r\n                             .map(item=>item ? item.firstname + ' ' + item.lastname : '')[0];\r\n        }\r\n        \r\n        function requestDescription(id) {\r\n           return id ? requests.value.find(item => item.id === id) : ''\r\n        }\r\n\r\n        function answerRequest(item) {\r\n            router.push(`/admin/dashboard/sentAnswer/${item.id}`);\r\n        }\r\n\r\n       function reassignRequest(item) {\r\n           router.push(`/admin/dashboard/reassign/${item.request_id}/${item.user_id}`);\r\n        }\r\n\r\n        function formatDate(date) {\r\n                return format(date,\"yyyy-MM-dd\");\r\n        }\r\n\r\n</script>\r\n\r\n<template>\r\n  <div class=\"admin-container mt-5\">\r\n    <div className=\"admin_table\">\r\n      <table class=\"table\" >\r\n        <thead>\r\n          <tr class=\"table-secondary\">\r\n            <th scope=\"col\">Ticket</th>\r\n            <th scope=\"col\">Category</th>\r\n            <th scope=\"col\">Description</th>\r\n            <th scope=\"col\">Status</th>\r\n             <th scope=\"col\">Comment</th>\r\n            <th scope=\"col\">Sender</th>\r\n            <th scope=\"col\">IT</th>\r\n            <th scope=\"col\">Date</th>\r\n            <th scope=\"col\">Action</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n           <tr class=\"table-light\" v-for=\"item in assignations\" :key=\"item.id\" >\r\n\r\n                    <td>\r\n                      {{requestDescription(item.request_id) ? requestDescription(item.request_id).title : ''}}\r\n                    </td>\r\n                    <td>\r\n                        <span class=\"fw-bold\" >\r\n                            {{requestDescription(item.request_id) ? categoryName(requestDescription(item.request_id).category_id) : '' }}\r\n                        </span>\r\n                    </td>\r\n                   \r\n                    <td>\r\n                            {{requestDescription(item.request_id) ? requestDescription(item.request_id).description : ''}}\r\n                    </td>\r\n                    <td>\r\n                      <span :class=\"{'badge bg-danger':item.state==='pending', 'badge bg-warning':item.state==='evaluate', 'badge bg-success':item.state==='complete' }\">\r\n                        {{item.state}}\r\n                      </span> \r\n                      </td>\r\n                    <td>\r\n                        <span class=\"fs-6\" >\r\n                            {{item.comment}}\r\n                        </span>\r\n                    </td>\r\n                    <td>{{userName(item.sender_id) }}</td>\r\n                    <td>{{userName(item.user_id) }}</td>\r\n                  \r\n                    <td>{{ item.date_assignation ? formatDate(item.date_assignation) : ''}}</td>\r\n                    <td>\r\n                        <button @click=\"answerRequest(item)\" :disabled=\"item.state!=='pending'\" v-if=\"currentUser.role_id===3\" :class=\"{'btn btn-small btn-secondary':item.state==='pending', 'btn btn-small btn-gray':item.state==='evaluate' , \r\n                        'btn btn-small btn-light':item.state==='complete' }\"  >\r\n                            Answer\r\n                        </button>\r\n                        <button @click=\"reassignRequest(item)\" :disabled=\"item.state==='complete'\" v-if=\"currentUser.role_id ===2\" :class=\"{'btn btn-small btn-dark':item.state==='pending', 'btn btn-small btn-secondary':item.state==='evaluate' , \r\n                        'btn btn-small btn-light':item.state==='complete' }\" >\r\n                            Reassign\r\n                        </button>\r\n                    </td>\r\n               </tr> \r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  </div>\r\n</template>\r\n"],"mappings":";AAEA,SAASA,YAAY,EAACC,gBAAgB,EAAEC,cAAc,EAAEC,SAAS,QAAO,gBAAgB;AACxF,SAASC,MAAM,QAAQ,UAAU;AACjC,SAASC,SAAS,QAAQ,KAAK;AAC/B,SAASC,GAAG,QAAQ,KAAK;AACzB,OAAOC,KAAK,MAAM,UAAU;AAC5B,OAAOC,MAAM,MAAM,WAAW;;;;;;;IAE3B,MAAMC,UAAU,GAAGH,GAAG,CAAC,EAAE,CAAC;IAC1B,MAAMI,KAAK,GAAGJ,GAAG,CAAC,EAAE,CAAC;IACrB,MAAMK,QAAQ,GAAGL,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMM,YAAY,GAAGN,GAAG,CAAC,EAAE,CAAC;IAC5B,MAAMO,WAAW,GAAGP,GAAG,CAAC,IAAI,CAAC;IAE/BD,SAAS,CAAC,YAAY;MAChBI,UAAU,CAACK,KAAK,GAAG,MAAMP,KAAK,CAACQ,QAAQ,CAACb,cAAc,CAAC;MACvDQ,KAAK,CAACI,KAAK,GAAG,MAAMP,KAAK,CAACQ,QAAQ,CAACZ,SAAS,CAAC;MAC7CQ,QAAQ,CAACG,KAAK,GAAG,MAAMP,KAAK,CAACQ,QAAQ,CAACf,YAAY,CAAC;MACnDY,YAAY,CAACE,KAAK,GAAG,MAAMP,KAAK,CAACQ,QAAQ,CAACd,gBAAgB,CAAC;MAC3DY,WAAW,CAACC,KAAK,GAAGP,KAAK,CAACS,KAAK,CAACC,IAAI,CAACC,SAAS,CAACD,IAAI;IAC1D,CAAC,CAAC;IAGK,SAASE,YAAYA,CAACC,EAAE,EAAE;MACtB,OAAOX,UAAU,CAACK,KAAK,CAACO,MAAM,CAACC,IAAI,IAAIA,IAAI,CAACF,EAAE,KAAKA,EAAE,CAAC,CAC9BG,GAAG,CAACD,IAAI,IAAEA,IAAI,GAAGA,IAAI,CAACE,IAAI,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;IAC9D;IAEA,SAASC,QAAQA,CAACL,EAAE,EAAE;MACnB,OAAOV,KAAK,CAACI,KAAK,CAACO,MAAM,CAACC,IAAI,IAAIA,IAAI,CAACF,EAAE,KAAKA,EAAE,CAAC,CAC9BG,GAAG,CAACD,IAAI,IAAEA,IAAI,GAAGA,IAAI,CAACI,SAAS,GAAG,GAAG,GAAGJ,IAAI,CAACK,QAAQ,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;IACpF;IAEA,SAASC,kBAAkBA,CAACR,EAAE,EAAE;MAC7B,OAAOA,EAAE,GAAGT,QAAQ,CAACG,KAAK,CAACe,IAAI,CAACP,IAAI,IAAIA,IAAI,CAACF,EAAE,KAAKA,EAAE,CAAC,GAAG,EAAE;IAC/D;IAEA,SAASU,aAAaA,CAACR,IAAI,EAAE;MACzBd,MAAM,CAACuB,IAAI,CAAE,+BAA8BT,IAAI,CAACF,EAAG,EAAC,CAAC;IACzD;IAED,SAASY,eAAeA,CAACV,IAAI,EAAE;MAC3Bd,MAAM,CAACuB,IAAI,CAAE,6BAA4BT,IAAI,CAACW,UAAW,IAAGX,IAAI,CAACY,OAAQ,EAAC,CAAC;IAC9E;IAEA,SAASC,UAAUA,CAACC,IAAI,EAAE;MAClB,OAAOhC,MAAM,CAACgC,IAAI,EAAC,YAAY,CAAC;IACxC"},"metadata":{},"sourceType":"module","externalDependencies":[]}