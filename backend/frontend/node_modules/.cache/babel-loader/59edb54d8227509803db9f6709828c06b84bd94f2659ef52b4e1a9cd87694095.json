{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { onMounted, ref } from \"vue\";\nimport { ADD_ASSIGNATION, GET_ASSIGNATIONS, GET_USERS, GET_REQUESTS } from \"../store/types\";\nimport store from '../store';\nimport router from '../routes';\nimport route from '../routes';\nexport default {\n  __name: 'AddAssignation',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const user_id = ref('');\n    const comment = ref('');\n    const request_id = ref('');\n    const assigner = ref('');\n    const assignError = ref('');\n    const loading = ref(false);\n    const users = ref([]);\n    const requests = ref([]);\n    const assignations = ref([]);\n    const reassign = ref(false);\n    onMounted(async () => {\n      assignations.value = await store.dispatch(GET_ASSIGNATIONS);\n      users.value = await store.dispatch(GET_USERS);\n      requests.value = await store.dispatch(GET_REQUESTS);\n      request_id.value = route.params && route.params.id ? route.params.id : \"\";\n      assigner.value = route.params && route.params.user ? route.params.user : \"\";\n      if (users.value && users.value.length) {\n        users.value = users.value.filter(item => item.role_id === 3);\n      }\n      if (requests.value && requests.value.length) {\n        requests.value = requests.value.filter(item => item.status === 'proccesing');\n      }\n\n      // execute when request reassign \n      if (route.params.id) {\n        request_id.value = route.params.id;\n        assigner.value = route.params.user;\n        reassign.value = true;\n        users.value = users.filter(item => item.id !== parseInt(assigner.value));\n      }\n    });\n    function saveAssignRequest() {\n      loading.value = true;\n      const data = {\n        request_id: request_id.value,\n        user_id: user_id.value,\n        comment: comment.value\n      };\n      store.dispatch(ADD_ASSIGNATION, data).then(data => {\n        loading.value = false;\n        if (data.status === \"success\") {\n          router.push(\"/admin/dashboard/assignations\");\n        }\n      }).catch(data => {\n        loading.value = false;\n        if (data === \"error\") {\n          assignError.value = store.state.request.message;\n        }\n      });\n    }\n    function updateRequest() {\n      // Get user assignations\n      if (assignations.value && assignations.value.length) {\n        assignations.value = assignations.value.filter(item => parseInt(item.user_id) === parseInt(this.user_id));\n      }\n\n      // remove request that is already assign to the user\n      if (this.assignations && this.assignations.length) {\n        this.assignations.map(assign => {\n          this.requests = this.requests.filter(item => parseInt(assign.request_id) !== parseInt(item.id));\n        });\n      }\n    }\n    const __returned__ = {\n      user_id,\n      comment,\n      request_id,\n      assigner,\n      assignError,\n      loading,\n      users,\n      requests,\n      assignations,\n      reassign,\n      saveAssignRequest,\n      updateRequest,\n      onMounted,\n      ref,\n      get ADD_ASSIGNATION() {\n        return ADD_ASSIGNATION;\n      },\n      get GET_ASSIGNATIONS() {\n        return GET_ASSIGNATIONS;\n      },\n      get GET_USERS() {\n        return GET_USERS;\n      },\n      get GET_REQUESTS() {\n        return GET_REQUESTS;\n      },\n      get store() {\n        return store;\n      },\n      get router() {\n        return router;\n      },\n      get route() {\n        return route;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","ADD_ASSIGNATION","GET_ASSIGNATIONS","GET_USERS","GET_REQUESTS","store","router","route","user_id","comment","request_id","assigner","assignError","loading","users","requests","assignations","reassign","value","dispatch","params","id","user","length","filter","item","role_id","status","parseInt","saveAssignRequest","data","then","push","catch","state","request","message","updateRequest","map","assign"],"sources":["C:/Users/HP/Desktop/ENFM/Customer_v2/client/src/views/AddAssignation.vue"],"sourcesContent":["<script setup>\r\nimport { onMounted, ref } from \"vue\";\r\nimport { ADD_ASSIGNATION,GET_ASSIGNATIONS, GET_USERS, GET_REQUESTS } from \"../store/types\"\r\nimport store from '../store'\r\nimport router from '../routes'\r\nimport route from '../routes'\r\n\r\n     const user_id = ref('')\r\n     const comment = ref('')\r\n     const request_id = ref('')\r\n     const assigner = ref('')\r\n     const assignError = ref('')\r\n     const loading = ref(false)\r\n     const users = ref([])\r\n     const requests = ref([]) \r\n     const assignations = ref([]) ;\r\n     const reassign = ref(false)\r\n\r\n    onMounted(async () =>{\r\n\r\n      assignations.value = await store.dispatch(GET_ASSIGNATIONS);\r\n      users.value = await store.dispatch(GET_USERS);\r\n      requests.value = await store.dispatch(GET_REQUESTS);\r\n      request_id.value = route.params && route.params.id ? route.params.id : \"\";\r\n      assigner.value = route.params && route.params.user ? route.params.user : \"\";\r\n    \r\n     if (users.value &&  users.value.length) {\r\n         users.value = users.value.filter(item => item.role_id === 3);\r\n     }\r\n\r\n     if (requests.value &&  requests.value.length) {\r\n        requests.value = requests.value.filter(item => item.status === 'proccesing');\r\n     }\r\n\r\n     // execute when request reassign \r\n     if (route.params.id) {\r\n        request_id.value = route.params.id;\r\n        assigner.value = route.params.user;\r\n        reassign.value = true;\r\n        users.value = users.filter(item => item.id !== parseInt(assigner.value));\r\n     }\r\n  })\r\n\r\n\r\n    function saveAssignRequest() {\r\n      \r\n      loading.value = true;\r\n      const data = {\r\n        request_id: request_id.value,\r\n        user_id: user_id.value,\r\n        comment: comment.value\r\n      };\r\n        store\r\n        .dispatch(ADD_ASSIGNATION, data)\r\n        .then((data) => {\r\n          loading.value = false;\r\n          if (data.status === \"success\") {\r\n             router.push(\"/admin/dashboard/assignations\");\r\n          }\r\n        })\r\n        .catch((data) => {\r\n          loading.value = false;\r\n          if (data === \"error\") {\r\n            assignError.value = store.state.request.message;\r\n          }\r\n        });\r\n    }\r\n\r\n     function updateRequest() {\r\n\r\n      // Get user assignations\r\n      if (assignations.value &&  assignations.value.length) {\r\n         assignations.value = assignations.value.filter(item => parseInt(item.user_id) === parseInt(this.user_id));\r\n      }\r\n \r\n     // remove request that is already assign to the user\r\n     if (this.assignations &&  this.assignations.length) {\r\n         this.assignations.map((assign) => {\r\n                this.requests = this.requests.filter(item => parseInt(assign.request_id) !== parseInt(item.id));\r\n         });\r\n     }\r\n  }\r\n</script>\r\n\r\n\r\n<template>\r\n  <form class=\"m-10 p-5\">\r\n    <div class=\"mb-4\">\r\n      <h3 class=\"text-dark\">ASSIGN REQUEST</h3>\r\n    </div>\r\n\r\n    <div class=\"mb-3\">\r\n      <p class=\"alert alert-danger\" v-show=\"assignError\">{{ assignError }}</p>\r\n    </div>\r\n\r\n    <div class=\"mb-3\">\r\n      <select class=\"form-control\" id=\"#it\" @change=\"updateRequest\" v-model=\"user_id\">\r\n        <option for=\"it\" value=\"\" :disabled=\"true\">\r\n          Select IT\r\n        </option>\r\n        <option for=\"it\" v-for=\"user in users\" :key=\"user.id\" :value=\"user.id\">\r\n          {{ user.firstname }}  {{ user.lastname }}\r\n        </option>\r\n      </select>\r\n    </div>\r\n\r\n    <div class=\"mb-3\" v-if=\"user_id && !reassign\">\r\n      <select class=\"form-control\" id=\"#request\"   v-model=\"request_id\">\r\n        <option for=\"request\" value=\"\" :disabled=\"true\">\r\n          Select Request\r\n        </option>\r\n        <option for=\"request\" v-for=\"req in requests\" :key=\"req.id\" :value=\"req.id\">\r\n          {{ req.description }} \r\n        </option>\r\n      </select>\r\n    </div>\r\n\r\n    <div class=\"mb-3\">\r\n      <textarea\r\n        rows=\"3\"\r\n        v-model=\"comment\"\r\n        class=\"form-control\"\r\n        id=\"passwordInput\"\r\n        placeholder=\"Enter a comment\"\r\n      />\r\n    </div>\r\n\r\n    <div class=\"mb-3\">\r\n      <button\r\n        :disabled=\"loading\"\r\n        @click.prevent=\"saveAssignRequest\"\r\n        :class=\"{'btn btn-lg btn-dark':!loading,'btn btn-lg btn-danger':loading}\"\r\n        type=\"button\"\r\n      >\r\n        Save\r\n      </button>\r\n    </div>\r\n  </form>\r\n</template>\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}